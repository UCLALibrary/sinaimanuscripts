language: ruby
cache:
  bundler: true
  directories:
    - tmp/solr_downloads
dist: trusty
sudo: false
jdk:
  - oraclejdk8
before_install:
  - mysql -e 'CREATE DATABASE IF NOT EXISTS ursus_test;'
env:
  global:
    - DATABASE_USERNAME=travis
    - secure: "N7Xkgo7xtlzPeZoGMC8cQ+EL6dB6GjKhhx9dTcnAMu3zdod/5Eqbgmxn+FuYu7AuqBN9cPhFsAiDwjxPSla5CTKndtbNVnNOTsnNjpznC5xYLclRY4XdPlwNVzsfX43bSqlBGQnNO8GmjwyMycETxlkHNAZzhkbVaY5GTdolAKwyl4ak4wAxMDI1iyAY0So3YpkS9ZOVYXdnnS3SqatP4aJOMzs28Idfa7LUKVoRWGTU2x5v+LUj+R4uPykV0A7CPQ/c12TWOfktIY+N/y7vWcGzxT2xLzAD4wUZFI8ST4NiF6/aUg4bJCsMicz6Mzvs00TN5KQaLSHg1mte7H5J9NM+RIyAgH6GJFj80e8Q/Sh3zYZeoF5uA/5NDdGrd0hYksMISjXiz2Haa0Z1+/MwAzOnpP98hX7XRb36MR3W6l1R4PQ695T7ZTOGl08um1DpvHDPt5NQbrwUZVjLcVELRIlRENvawDQ76Y2icH0dKPeTAA34R7CCPGhl5XCHcrA3fgFzpNhLUMxsJdJgGRNDQXqwF+xO7uVr9Q8PxPOfxprv31WuTHn189FlCI63XYlh1BcTj3jXQsM9/cqUzQ1BwFPsJA9rogmOeIiDGHdM6Aq7xRUqaoe/7ZX1WM9JVletipLjFSJRniIdhJ/AvwUNBiybk+N6bl/oor/tTSLpy/Y="
    - secure: "o+zonniBDVXAAT5MC+HHuF6vHOXYR98Iy5u54n3sMDJDvSE5b1Ez0H3cUfEOBCh8yoy9jpTj/AW9qE4Fl+r5RbO7/jxUd1Dl+qCTyZcKj2s41O3cXVCMhFqHwmumCvJW+wBzfjM3ZB48x3fW2FQhrUoHspC2beNrsh4ON7OZ3zY4AgWBPCBRDrkql4O/MS6EabnKIbAdoLGvNPOXBVBzl0dUE0PcQUtkqGYi5djjkW2q2ZcAnpM/58tQI41p76dMkzBZD5iZ8VzSAkEzTLuusUWnRbMmoiG8lqxxOzxu8YyGjY4SpGXOaM4vYppCJCP4OitwuGr2Ml3KaCwufPuk6V1dRCaV6l9YLPTshg24Mjf0s37Hsh1e4/u55t4jzofc4EzwDgSiO4sRBk1YtEOoOKzUcKcTFtY0p3qCoUJXBf27tmF6m9umT0E7FMEc1ExWBgso8/bFAYQLv/ZzJd3ysKasVnspJ+7COdN4AQCDLH0NNTTJP1p3vkD8tjFsYGpxwpcalHFU0nyvBSHHi5YYCbyhYsbum9UUMuoIjIoG7yn2FX7lhO4+zX/bgvxDFwtMFvFkUNXyuUKBJCcFlHKFWBQg/96zdM1HndUuwx6TmO5AizbYvJFFfafw2b3FxaSNK9XuDk8H2XC5vWOlRwJD/K0dO09HaG1l2y/hFhnLxVM="
rvm:
  - 2.5.1
script:
  - bundle exec rake ci
notifications:
  email: false
services:
  - mysql2
after_success:
- |
  if [[ $TRAVIS_BRANCH == 'master' && $TRAVIS_PULL_REQUEST == 'false' ]]; then
    curl "$JENKINS_DEPLOY_URL"
  fi
  if [[ $TRAVIS_TAG =~ ^sprint[0-9]*\.rc[0-9]* ]]; then
    echo "$TRAVIS_TAG"
    curl "$JENKINS_TAG_DEPLOY_URL"
  fi
